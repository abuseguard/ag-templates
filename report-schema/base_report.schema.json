{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://raw.githubusercontent.com/abuseguard/ag-templates/main/report-schema/base_report.schema.json",
    "$defs": {
        "ReporterInfo": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "ReporterType": {
                    "$comment": "Contact info is optional if the reporter is a natural person",
                    "enum": ["Org", "Person"],
                    "default": "Person"
                },
                "ReporterName": {
                    "type": "string"
                },
                "ReporterEmail": {
                    "type": "string"
                },
                "ReporterPhone": {
                    "type": "string"
                },
                "ReporterTitle": {
                    "type": "string"
                },
                "ReporterOrg": {
                    "type": "string"
                }
            },
            "if": {
                "not": { "properties": { "ReporterType": { "const": "Person" } } }
            },
            "then": {
                "required": ["ReporterOrg"]
            },
            "required": ["ReporterName","ReporterEmail","ReporterType"]
        }
    },
    "properties": {
        "Base": {
            "type":"object",
            "allOf": [
                {
                    "type":"object",
                    "properties": {
                        "ReporterInfo": {
                            "$ref":"#/$defs/ReporterInfo"
                        },
                        "OnBehalfOf": {
                            "$ref":"#/$defs/ReporterInfo"
                        }
                    }
                }
            ]
        }
    }
}
